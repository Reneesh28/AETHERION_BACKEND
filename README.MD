# ğŸ§  AETHERION â€” Backend Architecture

---

# ğŸ Current Status

**Day 1: System Bootstrap â€” âœ… Complete**
**Day 2: Market Data Simulator â€” âœ… Complete**

AETHERION backend is now running a live async market engine with OHLC aggregation.

---

# ğŸ— System Architecture

```
Django Core (Port 8000)   â†’ MySQL (3306)
FastAPI Market (Port 8001) â†’ MongoDB (27017)
Flask Regime (Port 8002)

FastAPI â†’ Flask (REST Communication)
```

This establishes a microservice-style backend separation.

---

# ğŸ“‚ Project Structure

```
AETHERION_BACKEND/
â”‚
â”œâ”€â”€ django_core/        # Django + MySQL (Control Tower)
â”œâ”€â”€ fastapi_market/     # FastAPI + MongoDB (Async Market Engine)
â”œâ”€â”€ flask_regime/       # Flask (Regime Engine)
â”œâ”€â”€ shared/             # Shared utilities (future use)
â”œâ”€â”€ requirements.txt
â”œâ”€â”€ .gitignore
â””â”€â”€ README.md
```

---

# âš™ï¸ Environment Setup

## 1ï¸âƒ£ Create Virtual Environment

```
python -m venv venv
venv\Scripts\activate
```

## 2ï¸âƒ£ Install Dependencies

```
pip install -r requirements.txt
```

---

# ğŸ“¦ requirements.txt

```
Django
djangorestframework
fastapi
uvicorn
flask
mysqlclient
motor
python-dotenv
requests
loguru
websockets
```

---

# ğŸ—„ Database Configuration

## MySQL (Django Core)

Create database:

```
CREATE DATABASE aetherion_core;
```

Apply migrations:

```
cd django_core
python manage.py migrate
```

---

## MongoDB (FastAPI Market)

Runs locally as Windows service:

```
mongodb://localhost:27017
```

Collections created dynamically:

* `market_ticks`
* `market_candles`

---

# â–¶ Running the Services

## Django Core (Port 8000)

```
cd django_core
python manage.py runserver 8000
```

Health check:

```
http://127.0.0.1:8000/health/
```

---

## FastAPI Market (Port 8001)

```
cd fastapi_market
python -m uvicorn main:app --port 8001
```

Health check:

```
http://127.0.0.1:8001/
```

Swagger docs:

```
http://127.0.0.1:8001/docs
```

---

## Flask Regime (Port 8002)

```
cd flask_regime
python app.py
```

Health check:

```
http://127.0.0.1:8002/health
```

---

# ğŸ”„ Inter-Service Communication

FastAPI â†’ Flask REST call:

```
http://127.0.0.1:8001/check-regime
```

Expected response:

```
{"status":"flask_regime running"}
```

---

# ğŸ“Š Day 2 â€” Market Data Simulator

## ğŸ¯ Objective

Generate a live simulated market with:

* Real-time tick generation
* MongoDB persistence
* WebSocket broadcasting
* 10-second OHLC candle aggregation

---

## ğŸ” Tick Engine

* Random-walk price simulation
* Volume simulation
* 1-second tick interval
* Logged using `loguru`

Mongo Collection:

```
market_ticks
```

---

## ğŸŒ WebSocket Endpoint

```
ws://127.0.0.1:8001/ws/market
```

Streams live ticks every second:

```
{
  "price": 101.22,
  "volume": 532,
  "timestamp": 1771230xxx,
  "_id": "..."
}
```

---

## ğŸ“ˆ Candle Aggregation (10-Second OHLC)

Every 10 seconds computes:

* Open
* High
* Low
* Close
* Aggregated Volume

Stored in Mongo:

```
market_candles
```

---

## ğŸ“¡ REST Endpoints

### Snapshot (Recent Ticks)

```
GET /api/market/snapshot
```

Returns latest stored ticks.

---

### Candle Data

```
GET /api/market/candles
```

Returns recent OHLC candles:

```
{
  "candles": [
    {
      "open": 100.75,
      "high": 102.28,
      "low": 100.75,
      "close": 102.28,
      "volume": 2380,
      "start_time": 1771230349,
      "end_time": 1771230359
    }
  ]
}
```

---

# âœ… Day 1 Completion Checklist

âœ” Django connected to MySQL
âœ” FastAPI connected to MongoDB
âœ” Flask running independently
âœ” All services on separate ports
âœ” Health endpoints operational
âœ” FastAPI â†’ Flask communication working

---

# âœ… Day 2 Completion Checklist

âœ” Random-walk price generator
âœ” Volume simulation
âœ” Tick persistence (MongoDB)
âœ” WebSocket real-time streaming
âœ” Proper JSON serialization handling
âœ” 10-second OHLC candle aggregation
âœ” Candle persistence
âœ” REST snapshot endpoint
âœ” REST candle endpoint

---

# ğŸ§  What Has Been Achieved

AETHERION now includes:

â€¢ Structured storage (MySQL via Django ORM)
â€¢ Async unstructured storage (MongoDB via Motor)
â€¢ Real-time WebSocket market streaming
â€¢ Tick-level data persistence
â€¢ OHLC aggregation engine
â€¢ Microservice REST communication
â€¢ Production-style backend separation

This forms the foundation for:

Market Intelligence â†’ Regime Detection â†’ Strategy Engine â†’ Risk Layer â†’ Surveillance

---

# ğŸ”œ Next Phase (Day 3 Preview)

* Background market engine (single loop, multi-client broadcast)
* Volatility metrics
* Trend detection
* Regime classification engine
* Strategy signal scaffolding

---

# ğŸš€ Current Status

AETHERION Backend
Day 1: COMPLETE
Day 2: COMPLETE

Live market engine operational.
